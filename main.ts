let canDoubleJump:boolean = false;
controller.A.onEvent(ControllerButtonEvent.Pressed, function () {
    if (hero.isHittingTile(CollisionDirection.Bottom)) {
        hero.vy = -120
    } else if (canDoubleJump) {
        hero.vy = -170
        canDoubleJump = false
    }
})
controller.left.onEvent(ControllerButtonEvent.Pressed, function () {
    hero.vx = -50
})
controller.right.onEvent(ControllerButtonEvent.Released, function () {
    hero.vx = 0
})
controller.left.onEvent(ControllerButtonEvent.Released, function () {
    hero.vx = 0
})
controller.right.onEvent(ControllerButtonEvent.Pressed, function () {
    hero.vx = 50
})
sprites.onOverlap(SpriteKind.Player, SpriteKind.Projectile, function (sprite, otherSprite) {
    game.over(true, effects.confetti)
})
sprites.onOverlap(SpriteKind.Player, SpriteKind.Food, function (sprite, otherSprite) {
    otherSprite.destroy(effects.trail, 250)
    otherSprite.y += -3
})
let coin: Sprite = null
let hero: Sprite = null
tiles.setCurrentTilemap(tiles.createTilemap(hex`400008000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000030000030000000000000000000000000000000000000000000000000000000000000000000000000300000000000000000000000000000000030000000000000000000000000300000002000000000000000000000000000000000000000000000000000000000000000000000000000003000003000003000200000003000000000000000000000000020000030000000300000000030000000000000000000300000000030000020000030000030000000000000000000002000000000000000000000000000000000200000000000000000200000000000004000001010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101`, img`
................................................................
................................................................
................................................................
................................................................
.............................................2..................
............................2................2..................
...........2................2................2........2.........
2222222222222222222222222222222222222222222222222222222222222222
`, [myTiles.transparency16, sprites.builtin.forestTiles25, sprites.builtin.brick, null, null], TileScale.Sixteen))
scene.setBackgroundImage(img`
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999ffff99999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999fffffffffffff9999999999ff111ff999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999fff1111111111111fff9999ffff111111ff9999999999999
    999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999ff111111111111111111fffff11111111111ff99999999999
    99999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999f1111111111111111111111111111111111111ff9999999999
    99999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999f11111111111111111111111111111111111111f9999999999
    99999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999f11111111111111111111111111111111111111f9999999999
    99999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999fff111111111111111111111111111111111111ffff9999999
    99999999999999999999ffffffffffff999999999999999999999999999999999999999999999999999999999999999999999999999999999fffffffffff1111111111111111111111111111f9999999
    9999999999999999fffff11111111111ffffffffff9999999999999999999999999999999999999999999999999999999999999999999999999999999999ff111111111111111111111111111f999999
    99999999999999fff111111111111111111111111ff9999999999999999999999999999999999999999999999999999999999999999999999999999999999fff111111111111111111111111ff999999
    9999999999999ff111111111111111111111111111ff999999999999999999999999999999999999999999999999999999999999999999999999999999999999fffffffffff1111111111111f9999999
    999999999999ff11111111111111111111111111111f9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999ff11111111111ff9999999
    999999999999f111111111111111111111111111111ff9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999fff111111ffff99999999
    99999999999f11111111111111111111111111111111f999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999fffffff999999999999
    99999999999f11111111111111111111111111111111ff999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999f1111111111111111111111111111111111f999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999f1111111111111111111111111111111111ff99999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999f11111111111111111111111188888888888889988888899999888889999998888888889999888888888888899888888999998888889999999999999999999999999999999999999999999
    9999999999f11111111111111111111111188888888888889988888899999888889999988888888889999888888888888899888888999988888889999999999999999999999999999999999999999999
    9999999999f11111111111111111111111188888888888889988888899999888889999888888888889999888888888888899888888999888888889999999999999999999999999999999999999999999
    9999999999f11111111111111111111111188888888888889988888889999888889998888888888889999888888888888899888888988888888999999999999999999999999999999999999999999999
    99999999999f111111111111111111111118888888888888f988888889999888889998888888888889999888888888888899888888988888888999999999999999999999999999999999999999999999
    99999999999f111111111111111111111118888811111111f988888889999888889998888888888889999888889999999999888888888888899999999999999999999999999999999999999999999999
    999999999999ff1111111111111111111118888811111111f988888888999888889998888888999999999888889999999999888888888888999999999999999999999999999999999999999999999999
    9999999999999ff111111111111111111118888811111111f988888888999888889998888899999999999888889999999999888888888899999999999999999999999999999999999999999999999999
    999999999999999ff1111111111111111118888811111111f988888888999888889999888888999999999888889999999999888888888999999999999999999999999999999999999999999999999999
    99999999999999999ffff111111ffffff11888888888811f9988888888899888889999988888888999999888888888899999888888889999999999999999999999999999999999999999999999999999
    99999999999999999999ffffffff99999ff8888888888fff9988888888899888889999998888888899999888888888899999888888889999999999999999999999999999999999999999999999999999
    999999999999999999999999999999999998888888888f999988888888889888889999999998888889999888888888899999888888888999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999988888888889999988888888889888889999999999888888999888888888899999888888888899999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999988888888889999988888888889888889999999999888888999888888888899999888888888889999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999988888999999999988888988888888889999999999888888999888889999999999888888888888999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999988888999999999988888998888888889999999999888888999888889999999999888888888888899999999999999999999999999999999999999999999999
    9999999999999999999999999999999999988888999999999988888998888888889999999998888888999888889999999999888888988888889999999999999999999999999999999999999999999999
    9999999999999999999999999999999999988888888888889988888999888888889999888888888889999888888888888899888888998888888999999999999999999999999999999999999999999999
    9999999999999999999999999999999999988888888888889988888999888888889999888888888899999888888888888899888888999888888899999999999999999999999999999999999999999999
    9999999999999999999999999999999999988888888888889988888999988888889999888888888999999888888888888899888888999988888889999999999999999999999999999999999999999999
    9999999999999999999999999999999999988888888888889988888999988888889999888888889999999888888888888899888888999998888889999999999999999999999999999999999999999999
    9999999999999999999999999999999999988888888888889988888999998888889999999999999999999888888888888899888888999999888889999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999944444444444444444444444444444449999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999944444444444444444444444444444449999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999944444444444444444444444444444449999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999944444444444444444444444444444449999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999944444444444444444444444444444449999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999944444444444444444444444444444449999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
    `)
hero = sprites.create(img`
    . . . . . . . . . . . . . . . . 
    . . . f f f f f f f f f f . . . 
    . . f e e e e e e e e e e f . . 
    . f e e e e e e e e e e e e f . 
    . f d e e d d d d d d d d d f . 
    . f d e d d f d d d d f d d f . 
    . f e d d d f d d d d f d d f . 
    . . f d d d f d d d d f d d f . 
    . . f d d d d d d d d d d d f . 
    . . f b a c c c c c c c c a f . 
    . . f d d d c c c c c c d d f . 
    . . f d d f f f b b f f f d f . 
    . . f b a a a a a a a a a f . . 
    . . . f b a a f f b a a f . . . 
    . . . . f f f . . f f f . . . . 
    . . . . . . . . . . . . . . . . 
    `, SpriteKind.Player)
scene.cameraFollowSprite(hero)
let coords = [
{ x: 3, y: 6 },
{ x: 8, y: 6 },
{ x: 11, y: 4 },
{ x: 14, y: 6 },
{ x: 17, y: 6 },
{ x: 20, y: 5 },
{ x: 23, y: 5 },
{ x: 26, y: 5 },
{ x: 28, y: 4 },
{ x: 32, y: 5 },
{ x: 35, y: 3 },
{ x: 38, y: 3 },
{ x: 41, y: 4 },
{ x: 45, y: 2 },
{ x: 48, y: 5 },
{ x: 52, y: 5 },
{ x: 57, y: 5 }
]
for (let point of coords) {
    coin = sprites.create(img`
        . . . . . f f f f f f . . . . . 
        . . . f f f f f f f f f f . . . 
        . . . f 4 4 4 4 4 4 4 4 f . . . 
        . . . f 4 4 4 f f 4 4 4 f . . . 
        . . . f 4 4 f f f f 4 4 f . . . 
        . . . f 4 4 f f f f 4 4 f . . . 
        . . . f 4 4 4 f f 4 4 4 f . . . 
        . . . f 4 4 4 4 4 4 4 4 f . . . 
        . . . f f f f f f f f f f . . . 
        . . . f f f f f f f f f f . . . 
        . . . f f f f f f f f f f . . . 
        . . . f f f f f f f f f f . . . 
        . . . f f f f f f f f f f . . . 
        . . . f f f f f f f f f f . . . 
        . . . f f f f f f f f f f . . . 
        . . . f f f f f f f f f f . . . 
        `, SpriteKind.Food)
    tiles.placeOnTile(coin, tiles.getTileLocation(point.x, point.y))
}
let finish = sprites.create(img`
    . . . . . . . 2 2 . . . . . . . 
    . . . . . 2 2 2 2 . . . . . . . 
    . . . . 2 2 2 2 2 . . . . . . . 
    . . . 2 2 2 2 2 2 . . . . . . . 
    . . 2 2 2 2 2 2 2 . . . . . . . 
    . . . . . . . . f . . . . . . . 
    . . . . . . . . f . . . . . . . 
    . . . . . . . . f . . . . . . . 
    . . . . . . . . f . . . . . . . 
    . . . . . . . . f . . . . . . . 
    . . . . . . . . f . . . . . . . 
    . . . . . . . . f . . . . . . . 
    . . . . . . . . f . . . . . . . 
    . . . . . e e e e e e e . . . . 
    . . . e e e e e e e e e e . . . 
    . . e e e e e e e e e e e e . . 
    `, SpriteKind.Projectile)
tiles.placeOnTile(finish, tiles.getTileLocation(61, 6))
game.onUpdate(function () {
    if (hero.isHittingTile(CollisionDirection.Top)) {
        hero.vy = 0
    }
    if (hero.isHittingTile(CollisionDirection.Bottom)) {
        hero.ay = 0
        canDoubleJump = true;
    } else {
        hero.ay = 294
    }
})
